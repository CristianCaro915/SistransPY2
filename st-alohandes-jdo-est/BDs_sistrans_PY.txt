--______________________________________________________________________________________________________
--CREACIÓN DE TABLAS CON RESTRICCIONES BÁSICAS
--______________________________________________________________________________________________________
CREATE TABLE PERSONANATURAL(
ID_PN INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15)NOT NULL, VINCULO VARCHAR2(10) NOT NULL);

CREATE TABLE PROPIETARIOINMUEBLE(
ID_PI INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15)NOT NULL, VINCULO VARCHAR2(10)NOT NULL);

CREATE TABLE INMUEBLE(
ID_I INT GENERATED ALWAYS AS IDENTITY, TIPOI VARCHAR2(15) NOT NULL, UBICACION VARCHAR2(10) NOT NULL, 
COSTOADMIN INT NOT NULL,DISPONIBILIDAD INT NOT NULL, NUMHABITACIONES INT NOT NULL, ID_PROPIETARIOI INT, ID_SUJETOC INT);

CREATE TABLE EMPRESA(
ID_E INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15) NOT NULL);

CREATE TABLE SEGURO(
ID_S INT GENERATED ALWAYS AS IDENTITY, FECHAVENCE VARCHAR2(10)NOT NULL, DESCRIPCIÓN VARCHAR2(25) NOT NULL, ID_INMUEBLE INT);

CREATE TABLE CONTRATO(
ID_C INT GENERATED ALWAYS AS IDENTITY, TIPOCONTRATO VARCHAR2(10) NOT NULL, DURACION INT NOT NULL, DURACIONPREPAID INT
,PRECIOESPECIAL INT, PRECIOFINAL INT NOT NULL, FECHAINICIO DATE NOT NULL, FECHAPAGOMENSUAL DATE NOT NULL, ID_EMPRESA INT,
ID_PERSONANATUAL INT,ID_PROPIETARIOI INT);

CREATE TABLE SUJETOCOMUNIDAD(ID_SC INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15)NOT NULL, VINCULO VARCHAR2(10)NOT NULL);

CREATE TABLE HOTEL(
ID_HT INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15) NOT NULL);

CREATE TABLE HOSTAL(
ID_HS INT GENERATED ALWAYS AS IDENTITY, NOMBRE VARCHAR2(15)NOT NULL, RECEPCION INT NOT NULL, 
HORACIERRE DATE NOT NULL, HORAAPERTURA DATE NOT NULL);

CREATE TABLE HABITACION(
NUMHABITACION INT GENERATED ALWAYS AS IDENTITY, TAMANIO INT, TIPOH VARCHAR2(10), PRECIOFINAL INT, UBICACION VARCHAR2(10),
ID_HOSTAL INT,ID_HOTEL INT,ID_CONTRATO INT,ID_INMUEBLE INT);

CREATE TABLE SERVICIOH(
ID_SH INT GENERATED ALWAYS AS IDENTITY,PRECIO INT NOT NULL, INCLUIDO INT NOT NULL, CANTIDAD INT NOT NULL, NOMBRE VARCHAR2(20) NOT NULL);

--CREAR DESPUES DE AÑADIR RESTRICCIONES INICIALES 
CREATE TABLE BRINDAN(
ID_HABITACION INT CONSTRAINT FK_ID_HABITACION REFERENCES HABITACION (NUMHABITACION),
ID_SERVICIOH INT CONSTRAINT FK_ID_SERVICIOH REFERENCES SERVICIOH (ID_SH),
CONSTRAINT PK_BRINDAN PRIMARY KEY (ID_HABITACION,ID_SERVICIOH));
--______________________________________________________________________________________________________
--AÑADIR RESTRICCIONES INICIALES
--______________________________________________________________________________________________________
ALTER TABLE PERSONANATURAL ADD CONSTRAINT PK_PERSONANATURAL PRIMARY KEY (ID_PN) ENABLE;
ALTER TABLE PERSONANATURAL ADD CONSTRAINT CK_PERSONANATURAL CHECK 
(VINCULO IN ('PROFESOR','EMPLEADO','PADRE','ESTUDIANTE','EGRESADO','VECINO','PADREFAMILIA')) ENABLE;

ALTER TABLE PROPIETARIOINMUEBLE ADD CONSTRAINT PK_PROPIETARIOINMUEBLE PRIMARY KEY (ID_PI) ENABLE;
ALTER TABLE PROPIETARIOINMUEBLE ADD CONSTRAINT CK_PROPIETARIOINMUEBLE CHECK 
(VINCULO IN ('PROFESOR','EMPLEADO','PADRE','ESTUDIANTE','EGRESADO','VECINO','PADREFAMILIA')) ENABLE;

ALTER TABLE INMUEBLE ADD CONSTRAINT PK_INMUEBLE PRIMARY KEY (ID_I) ENABLE;
ALTER TABLE INMUEBLE ADD CONSTRAINT CK_INMUEBLE CHECK (TIPOI IN ('VIVIENDA','APARTAMENTO')) ENABLE;
ALTER TABLE INMUEBLE ADD CONSTRAINT CK2_INMUEBLE CHECK (DISPONIBILIDAD IN (0,1));

ALTER TABLE EMPRESA ADD CONSTRAINT PK_EMPRESA PRIMARY KEY (ID_E) ENABLE;

ALTER TABLE SEGURO ADD CONSTRAINT PK_SEGURO PRIMARY KEY (ID_S) ENABLE;

ALTER TABLE CONTRATO ADD CONSTRAINT PK_CONTRATO PRIMARY KEY (ID_C) ENABLE;
ALTER TABLE CONTRATO ADD CONSTRAINT CK_CONTRATO CHECK (TIPOCONTRATO IN ('DIARIO','MENSUAL','ANUAL')) ENABLE;

ALTER TABLE SUJETOCOMUNIDAD ADD CONSTRAINT PK_SUJETOCOMUNIDAD PRIMARY KEY (ID_SC) ENABLE;
ALTER TABLE SUJETOCOMUNIDAD ADD CONSTRAINT CK_SUJETOCOMUNIDAD CHECK 
(VINCULO IN ('PROFESOR','EMPLEADO','PADRE','ESTUDIANTE','EGRESADO','VECINO','PADREFAMILIA')) ENABLE;

ALTER TABLE HOTEL ADD CONSTRAINT PK_HOTEL PRIMARY KEY (ID_HT) ENABLE;

ALTER TABLE HOSTAL ADD CONSTRAINT PK_HOSTAL PRIMARY KEY (ID_HS) ENABLE;
ALTER TABLE HOSTAL ADD CONSTRAINT CK_HOSTAL CHECK (RECEPCION IN (0,1)) ENABLE;
ALTER TABLE HOSTAL ADD CONSTRAINT CK_HOSTAL_TIME CHECK (HORAAPERTURA<HORACIERRE) ENABLE; 

ALTER TABLE HABITACION ADD CONSTRAINT PK_HABITACION PRIMARY KEY (NUMHABITACION) ENABLE;
ALTER TABLE HABITACION ADD CONSTRAINT CH_HABITACIOON CHECK (TIPOH IN ('COMPARTIDO','INDIVIDUAL','ESTANDAR','SUITE','SEMISUITE')) ENABLE;

ALTER TABLE SERVICIOH ADD CONSTRAINT PK_SERVICIOH PRIMARY KEY (ID_SH) ENABLE;
ALTER TABLE SERVICIOH ADD CONSTRAINT CK_SERVICIOH CHECK(NOMBRES IN ('SALA','JACUZZI','COCINETA','BAÑOCOMPARTIDO','TVCABLE','AMOBLADO',
'AGUA','LUZ','GAS','INTERNET','TELEFONIA','PISCINA','RESTAURANTE','PARQUEADERO','RECEPCION24','SALAESTUDIO','GIMNASIO','SALASOCIAL')) ENABLE; 
ALTER TABLE SERVICIOH ADD CONSTRAINT CK2_SERVICIOH CHECK(INCLUIDO IN (0,1));





--______________________________________________________________________________________________________
--AÑADIR FOREIGN KEYS
--______________________________________________________________________________________________________

ALTER TABLE INMUEBLE ADD CONSTRAINT FK_I_PI FOREIGN KEY (ID_PROPIETARIOI) REFERENCES PROPIETARIOINMUEBLE(ID_PI) ENABLE;
ALTER TABLE INMUEBLE ADD CONSTRAINT FK_I_SC FOREIGN KEY (ID_SUJETOC) REFERENCES SUJETOCOMUNIDAD(ID_SC) ENABLE;

ALTER TABLE SEGURO ADD CONSTRAINT FK_SEGURO_INMUEBLE FOREIGN KEY (ID_INMUEBLE) REFERENCES INMUEBLE(ID_I) ENABLE; 

ALTER TABLE CONTRATO ADD CONSTRAINT FK_CONTRARO_EMPRESA FOREIGN KEY (ID_EMPRESA) REFERENCES EMPRESA (ID_E) ENABLE;
ALTER TABLE CONTRATO ADD CONSTRAINT FK_CONTRARO_PERSONANATURAL FOREIGN KEY (ID_PERSONANATUAL) REFERENCES PERSONANATURAL (ID_PN) ENABLE;
ALTER TABLE CONTRATO ADD CONSTRAINT FK_CONTRARO_PROPIETARIOINMUEBLE FOREIGN KEY (ID_PROPIETARIOI) REFERENCES 
PROPIETARIOINMUEBLE (ID_PI) ENABLE;

ALTER TABLE HABITACION ADD CONSTRAINT FK_HABITACION_HOSTAL FOREIGN KEY (ID_HOSTAL) REFERENCES HOSTAL (ID_HS) ENABLE;
ALTER TABLE HABITACION ADD CONSTRAINT FK_HABITACION_HOTEL FOREIGN KEY (ID_HOTEL) REFERENCES HOTEL (ID_HT) ENABLE;
ALTER TABLE HABITACION ADD CONSTRAINT FK_HABITACION_CONTRATO FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO (ID_C) ENABLE;
ALTER TABLE HABITACION ADD CONSTRAINT FK_HABITACION_INMUEBLE FOREIGN KEY (ID_INMUEBLE) REFERENCES INMUEBLE (ID_I) ENABLE;

--______________________________________________________________________________________________________
--INSERTAR DATA
--______________________________________________________________________________________________________
INSERT INTO PERSONANATURAL (NOMBRE,VINCULO) VALUES ('Mike Pence','ESTUDIANTE');
INSERT INTO PERSONANATURAL (NOMBRE,VINCULO) VALUES ('Richard I','PROFESOR');
INSERT INTO PERSONANATURAL (NOMBRE,VINCULO) VALUES ('Mehmet II','PROFESOR');

INSERT INTO PROPIETARIOINMUEBLE (NOMBRE,VINCULO) VALUES ('Jonnas Brother','EGRESADO');
INSERT INTO PROPIETARIOINMUEBLE (NOMBRE,VINCULO) VALUES ('Mikaela','PROFESOR');
INSERT INTO PROPIETARIOINMUEBLE (NOMBRE,VINCULO) VALUES ('Judas IV','PADREFAMILIA');

INSERT INTO EMPRESA (NOMBRE) VALUES ('Siestas DonJuan');
INSERT INTO EMPRESA (NOMBRE) VALUES ('El momilon');
INSERT INTO EMPRESA (NOMBRE) VALUES ('Adolfmir S.A.S');

INSERT INTO SUJETOCOMUNIDAD (NOMBRE,VINCULO) VALUES ('Pompeyo','EGRESADO');
INSERT INTO SUJETOCOMUNIDAD (NOMBRE,VINCULO) VALUES ('Margaret','PROFESOR');
INSERT INTO SUJETOCOMUNIDAD (NOMBRE,VINCULO) VALUES ('Slimshady','PADREFAMILIA');

INSERT INTO HOTEL (NOMBRE) VALUES ('Monte Deli');
INSERT INTO HOTEL (NOMBRE) VALUES ('El Zorro');
INSERT INTO HOTEL (NOMBRE) VALUES ('Crepusculo');
--REVISAR INSERTS SOBRE DATE PARA SOLO TENER LA HORA. Ó SOLO OBTENER LA HORA.
INSERT INTO HOSTAL (NOMBRE,RECEPCION,HORACIERRE,HORAAPERTURA) VALUES ('Rapid-in',1,
TO_DATE('11:05:00', 'HH:MI:SS'),TO_DATE('05:45:30', 'HH:MI:SS'));
INSERT INTO HOSTAL (NOMBRE,RECEPCION,HORACIERRE,HORAAPERTURA) VALUES ('Rapid-in',0,
TO_DATE('10:29:00', 'HH:MI:SS'),TO_DATE('07:28:30', 'HH:MI:SS'));

INSERT INTO SERVICIOH (PRECIO,INCLUIDO,CANTIDAD,NOMBRES) VALUES (12,0,3,'BAÑOCOMPARTIDO');
INSERT INTO SERVICIOH (PRECIO,INCLUIDO,CANTIDAD,NOMBRES) VALUES (23,1,1,'AGUA');
INSERT INTO SERVICIOH (PRECIO,INCLUIDO,CANTIDAD,NOMBRES) VALUES (90,1,4,'PARQUEADERO');

INSERT INTO INMUEBLE (TIPOI,UBICACION,COSTOADMIN,NUMHABITACIONES,ID_PROPIETARIO,ID_SUJETOC) VALUES ();

INSERT INTO SEGURO (FECHAVENCE,DESCRIPCION,ID_INMUEBLE) VALUES ();

INSERT INTO CONTRATO (TIPOCONTRATO,DURACION,DURACIONPREPAID,PRECIOESPECIAL,PRECIOFINAL,ID_EMPRESA,ID_PERSONANATURAL,ID_PROPIETARIOI)
VALUES ();

INSERT INTO HABITACION (TAMANIO,TIPOH,UBICACION,ID_HOSTAL,ID_HOTEL,ID_CONTRATO,ID_INMUEBLE) VALUES ();

INSERT INTO BRINDAN (ID_HABITACION,ID_SERVICIOH) VALUES ();